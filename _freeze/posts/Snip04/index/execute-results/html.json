{
  "hash": "1a4a685f85ee4fe32293fb3ec6229b42",
  "result": {
    "markdown": "---\ntitle: \"Snippet #4: boxplots and scatterplots: simple recipes\"\nauthor: \"Giorgio Luciano\"\ndate: \"2023-03-11\"\ncategories: \n  - R\n  - tutorials\n  - ggplot\n  - visualization\n  - recipes\nbibliography: references.bib\n---\n\n\n1.  Simulate data, check and assign *data types*\n2.  Create a scatterplot with `ggplot`\n3.  Create violin plot with `ggstatsplot`\n\nExample 1: We want to visualize the difference between two groups of patients that follow two different diets. *Group A* has an average of total cholesterol of *180* with a standard deviation of *20* while *Group B* and average of *200* with a standard deviation of 40\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlibrary(ggplot2)\nlibrary(data.table)\n\n\nnpatientsA <- 500\nnpatientsB <- 520\ncholA <- mvrnorm(n=npatientsA, mu=180, Sigma=20, empirical=T)\ncholB <- mvrnorm(n=npatientsB, mu=200, Sigma=40, empirical=T)\n\ndataA <- cbind(cholA,rep(\"A\",npatientsA))  \ndataB <- cbind(cholB,rep(\"B\",npatientsB))  \n\ndata <- data.frame(rbind(dataA,dataB))\ncolnames(data) <- c(\"Cholesterol\",\"group\")\ndata$Cholesterol <- as.numeric(data$Cholesterol)\n\np1 <-ggplot(data, aes(x = group, y = Cholesterol)) + geom_jitter(alpha=0.05) \n\np1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nA few observations on the code. First of all, we need to input the data in a `data.frame` otherwise ggplot will give us an error. The second observation is that since we put `chr` labels on our groups we needed to define Cholesterol `as.numeric` in order to avoid unwanted resultsstrange results. Try to comment the line `data$Cholesterol <- as.numeric(data$Cholesterol)` and you can see by yourself what will happen. (hint: a \"labelstorm!\")\n\nJiiter plots is one of my favorite way to represent data. data and immediately understand the distribution of your data and also avoid the pitfall of boxplot (see [@matejka2017])\n\nIf you need inferential statistics on your data another resource is [@ggstatsplot]. See the following example with our data. **NOTE** that we nee to transform the group label *as.factor*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggstatsplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nYou can cite this package as:\n     Patil, I. (2021). Visualizations with statistical details: The 'ggstatsplot' approach.\n     Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167\n```\n:::\n\n```{.r .cell-code}\ndata$group <- as.factor(data$group)\n\npstack  <- ggbetweenstats(data,group,Cholesterol)\n                          \npstack    \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}